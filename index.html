<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AquaMonitor – Dashboard</title>

  <!-- Fonte opcional -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Seu CSS principal -->
  <link rel="stylesheet" href="dashboard.css" />
</head>
<body>
  <!-- ===== TOPO / NAV ===== -->
  <header class="am-header" role="banner" aria-label="Barra superior">
    <div class="am-brand">
      <div class="am-logo" aria-hidden="true">AM</div>
      <span class="am-title">AquaMonitor</span>
    </div>

    <!-- Indicador (opcional) de conexão RTDB -->
    <small id="conn-dot" class="conn">
      <span id="conn-led" class="conn-led"></span>
      <span id="conn-txt" class="conn-txt">Conectando...</span>
    </small>

    <nav class="am-actions" aria-label="Ações">
      <a class="btn btn-ghost" href="login.html">Sair</a>
    </nav>
  </header>

  <!-- ===== CONTEÚDO ===== -->
  <main class="am-container" role="main">
    <h1 class="am-h1">Consumo, status da bomba e controle em tempo real.</h1>

    <!-- === Linha: NÍVEIS === -->
    <section class="grid grid-2">
      <!-- Caixa Principal -->
      <article class="card" aria-labelledby="h-caixa">
        <h2 id="h-caixa" class="card-title">Caixa Principal</h2>

        <div class="kpi">
          <div class="kpi-value" id="main-level-value">--%</div>
          <div class="kpi-sub">
            <span id="main-level-liters">-- L</span>
          </div>
        </div>

        <div class="bar">
          <div id="level-fill-main" class="bar-fill" style="width:0%"></div>
        </div>

        <div class="tank">
          <div class="tank-body">
            <div id="client-water-main" class="tank-water" style="height:0%"></div>
          </div>
          <div class="tank-caption">
            Principal (<span id="client-level-percent-main">0</span>%)
          </div>
        </div>
      </article>

      <!-- Reservatório -->
      <article class="card" aria-labelledby="h-res">
        <h2 id="h-res" class="card-title">Reservatório</h2>

        <div class="kpi">
          <div class="kpi-value" id="res-level-value">--%</div>
          <div class="kpi-sub">
            <span id="res-level-liters">-- L</span>
          </div>
        </div>

        <div class="bar">
          <div id="level-fill-res" class="bar-fill" style="width:0%"></div>
        </div>

        <div class="tank">
          <div class="tank-body">
            <div id="client-water-res" class="tank-water" style="height:0%"></div>
          </div>
          <div class="tank-caption">
            Reservatório (<span id="client-level-percent-res">0</span>%)
          </div>
        </div>
      </article>
    </section>

    <!-- === Linha: STATUS / MODO / CONTROLE === -->
    <section class="grid grid-3">
      <!-- Status da Bomba -->
      <article class="card subtle" aria-labelledby="h-status-bomba">
        <h2 id="h-status-bomba" class="card-title">Status da Bomba</h2>
        <div class="status-pill">
          <span id="pump-status-value" class="pill">--</span>
        </div>
        <p id="pump-status-text" class="muted">A bomba está --.</p>
      </article>

      <!-- Modo de Operação -->
      <article class="card subtle" aria-labelledby="h-modo-op">
        <h2 id="h-modo-op" class="card-title">Modo de Operação</h2>
        <div class="status-pill">
          <span id="mode-value" class="pill">--</span>
        </div>
        <p id="mode-text" class="muted">Operando em modo --.</p>
      </article>

      <!-- Controle da Bomba -->
      <article class="card outlined" aria-labelledby="h-controle">
        <h2 id="h-controle" class="card-title">Controle da Bomba</h2>

        <label class="switch">
          <input type="checkbox" id="auto-mode-switch" />
          <span>Modo Automático</span>
        </label>

        <div class="row gap">
          <button id="motor-button" type="button" class="btn btn-danger">Desligar Bomba</button>
        </div>

        <p class="muted">
          Status atual: <b id="motor-status">--</b>
        </p>
      </article>
    </section>

    <!-- === Linha: MODO FÉRIAS === -->
    <section class="grid grid-1">
      <article class="card hint" aria-labelledby="h-ferias">
        <div class="card-head">
          <h2 id="h-ferias" class="card-title">Modo Econômico (Férias)</h2>
          <span class="dot dot-live" aria-hidden="true"></span>
        </div>

        <p class="muted">
          Reduz o consumo: aplica limites <b>15%</b> (liga) e <b>50%</b> (desliga) enquanto ativo.
        </p>

        <div class="row gap">
          <button id="btn-ferias" type="button" class="btn btn-primary">Ativar Modo Férias</button>
        </div>

        <p id="ferias-info" class="small muted">
          <b>Modo Férias:</b> Usa limites de 15% a 50% para economizar.
        </p>
      </article>
    </section>

    <!-- === Linha: CONSUMO / GRÁFICO === -->
    <section class="grid grid-2">
      <!-- Consumo -->
      <article class="card" aria-labelledby="h-consumo">
        <h2 id="h-consumo" class="card-title">Consumo Estimado</h2>
        <div class="kpi">
          <div id="consumption-value" class="kpi-value">-- L/dia</div>
        </div>
        <p id="consumption-text" class="muted">Estimando pelo histórico...</p>

        <div class="exporter">
          <div class="export-title">Exportar histórico:</div>
          <div class="export-row">
            <label>
              Período
              <select id="export-range" class="input">
                <option value="7">Últimos 7 dias</option>
                <option value="30">Últimos 30 dias</option>
              </select>
            </label>

            <label>
              Formato
              <select id="export-format" class="input">
                <option value="simple">Simples (Data; Hora; Caixa%; Reservatório%)</option>
                <option value="full">Completo (inclui timestamp_ms)</option>
              </select>
            </label>

            <label>
              Separador
              <select id="export-sep" class="input">
                <option value=";">Ponto e vírgula (;)</option>
                <option value=",">Vírgula (,)</option>
              </select>
            </label>

            <button id="btn-export-csv" type="button" class="btn btn-secondary">Exportar CSV</button>
          </div>
          <p class="small muted">CSV pronto para Excel/Sheets.</p>
        </div>
      </article>

      <!-- Gráfico -->
      <article class="card" aria-labelledby="h-grafico">
        <h2 id="h-grafico" class="card-title">Histórico de Nível (Caixa Principal)</h2>
        <div class="chart-wrap">
          <canvas id="levelChart" aria-label="Gráfico do nível da caixa principal" role="img"></canvas>
        </div>
      </article>
    </section>
  </main>

  <noscript>Ative o JavaScript para usar o painel.</noscript>

  <!-- ===== SCRIPTS ===== -->
  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <!-- Chart.js (opcional, se for usar o gráfico) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- Lógica do painel -->
  <script src="./dashboard.js"></script>
</body>
</html>

